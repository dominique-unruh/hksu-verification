include "Adv_INDCCA_encFO.qrhl".
include "queryG.qrhl".

# GRAPH: EQ("queryG_invariant","queryG","queryG")
qrhl queryG_invariant:
  {â„­ğ”©ğ”[G1 = G2] âŠ“ âŸ¦quantA1, Hin1, Hout1, Gin1, Gout1âŸ§ â‰¡ğ”® âŸ¦quantA2, Hin2, Hout2, Gin2, Gout2âŸ§}
          call queryG; ~ call queryG; 
  {â„­ğ”©ğ”[G1 = G2] âŠ“ âŸ¦quantA1, Hin1, Hout1, Gin1, Gout1âŸ§ â‰¡ğ”® âŸ¦quantA2, Hin2, Hout2, Gin2, Gout2âŸ§}.

  inline queryG.
  wp 1 1.
  skip.
  # Just "simp." would work instead of the following commands. But it takes very long.
  isa (use [[simp_depth_limit=1]] in â€¹simp add: TERMâ€º).
  isa (subst top_lift, simp)+.
  isa (use [[simp_depth_limit=0]] in â€¹simp add: TERMâ€º).
  isa (subst G2G2, simp).
  simp!.
qed.
